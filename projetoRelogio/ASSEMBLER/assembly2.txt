JSR @INICIA_MEMORIA
NOP

%LABEL MAIN_LOOP
JSR @SR_REFRESH_DISPLAY
NOP
JSR @INCREMENTA_HORARIO
NOP
JMP @MAIN_LOOP

%LABEL INICIA_MEMORIA
LDI R0, $0
LDI R1, $1
LDI R2, $9

STA R1, @ADDR_CTE1
STA R0, @ADDR_COUNTER_SEG_UN    
STA R0, @ADDR_COUNTER_SEG_DEZ   
STA R0, @ADDR_COUNTER_MIN_UN    
STA R0, @ADDR_COUNTER_MIN_DEZ   
STA R0, @ADDR_COUNTER_HOR_UN    
STA R0, @ADDR_COUNTER_HOR_DEZ   

STA R0, @ADDR_LIMIT_SEG_UN
STA R0, @ADDR_LIMIT_SEG_DEZ
STA R0, @ADDR_LIMIT_MIN_UN
STA R0, @ADDR_LIMIT_MIN_DEZ
STA R0, @ADDR_LIMIT_HOR_UN
STA R0, @ADDR_LIMIT_HOR_DEZ

STA R0, @FPGA_RESET
STA R0, @LEDR
RET

%LABEL SR_REFRESH_DISPLAY
LDA R3, @ADDR_COUNTER_SEG_UN     #-- LOAD UNIDADE
STA R3, @HEX0                    #-- ARMAZENA EM HEX0
LDA R3, @ADDR_COUNTER_SEG_DEZ    #-- LOAD DEZENA 
STA R3, @HEX1                    #-- ARMAZENA EM HEX1
LDA R3, @ADDR_COUNTER_MIN_UN     #-- LOAD CENTENA
STA R3, @HEX2                    #-- ARMAZENA EM HEX2
LDA R3, @ADDR_COUNTER_MIN_DEZ    #-- LOAD MILHAR
STA R3, @HEX3                    #-- ARMAZENA EM HEX3
LDA R3, @ADDR_COUNTER_HOR_UN     #-- LOAD DEZ.MILHAR 
STA R3, @HEX4                    #-- ARMAZENA EM HEX4
LDA R3, @ADDR_COUNTER_HOR_DEZ    #-- LOAD CEN.MILHAR 
STA R3, @HEX5                    #-- ARMAZENA EM HEX5
RET

%LABEL INCREMENTA_HORARIO
JMP @VERIFICA
NOP

%LABEL VERIFICA
CEQ R1, @KEY0
JEQ @INCREMENTA_SEGUNDO_UN
NOP
RET

%LABEL INCREMENTA_SEGUNDO_UN
STA  R3, @CLEAR_KEY0
LDA  R3, @ADDR_COUNTER_SEG_UN
SOMA R3, @ADDR_CTE1
STA  R3, @ADDR_COUNTER_SEG_UN
RET



